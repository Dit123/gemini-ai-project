<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gemini 2.0 Flash</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@24,400,0,0" />
  <link rel="stylesheet" href="main.css">
</head>
<body>
  <header class="header">
    <h1 class="title">Hello, there</h1>
    <p class="subtitle">How can I help you today?</p>
    <ul class="suggestion-list">
      <li class="suggestion">
        <h4 class="text">Help me with my Aissgnment.</h4>
        <span class="icon material-symbols-rounded">draw</span>
      </li>
      <li class="suggestion">
        <h4 class="text">What are the best tips to improve my public speaking skills?</h4>
        <span class="icon material-symbols-rounded">lightbulb</span>
      </li>
      <li class="suggestion">
        <h4 class="text">Can you help me find the latest news on web development?</h4>
        <span class="icon material-symbols-rounded">explore</span>
      </li>
      <li class="suggestion">
        <h4 class="text">Write JavaScript code to sum all elements in an array.</h4>
        <span class="icon material-symbols-rounded">code</span>
      </li>
    </ul>
  </header>
  <div class="chat-list"></div>
  <div class="typing-area">
    <form action="#" class="typing-form">
      <div class="input-wrapper">
        <input type="text" placeholder="Enter a prompt here" class="typing-input" required />
        <button id="send-message-button" class="icon material-symbols-rounded">send</button>
      </div>
      <div class="action-buttons">
        <span id="theme-toggle-button" class="icon material-symbols-rounded">light_mode</span>
        <span id="delete-chat-button" class="icon material-symbols-rounded">delete</span>
      </div>
    </form>
    <video id="video-stream" width="640" height="480" autoplay></video>
    <button id="start-video">Start Video</button>
    <button id="start-voice">Start Voice</button>
    <button id="stopVideoButton">Stop Video</button>
    <button id="stopButton">Stop Voice</button>
    <p id="output">Your voice input will appear here...</p>
    <video id="video" autoplay muted style="width: 100%; max-width: 400px;"></video>
    <p class="disclaimer-text">
      Gemini 2.0 Flash may display inaccurate info, including about people, so double-check its responses.
    </p>
  </div>
  <button id="start-all">Start Video & Voice</button>
  <script>
    document.getElementById('start-all').addEventListener('click', () => {
        startVideo();
        startRecognition();
    });
    </script>

<script>
  async function fetchInteractions() {
      try {
          const response = await fetch('/gemini/interactions');
          if (!response.ok) {
              throw new Error('Failed to fetch interactions');
          }
          const data = await response.json();
          displayInteractions(data.interactions);
      } catch (error) {
          console.error(error);
          alert('Error fetching interactions');
      }
  }

  function displayInteractions(interactions) {
      const container = document.getElementById('interactions-container');
      container.innerHTML = '';
      if (interactions.length === 0) {
          container.innerHTML = '<p>No interactions found.</p>';
          return;
      }
      interactions.forEach((interaction) => {
          const interactionElement = document.createElement('div');
          interactionElement.textContent = interaction.message;
          container.appendChild(interactionElement);
      });
  }

  document.addEventListener('DOMContentLoaded', fetchInteractions);

  document.getElementById('ask-form').addEventListener('submit', async (event) => {
      event.preventDefault(); 
      const input = document.getElementById('ask-input').value;
      try {
          const response = await fetch('/gemini/ask', {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify({ question: input })
          });
          if (!response.ok) {
              throw new Error('Failed to ask Gemini');
          }
          const data = await response.json();
          document.getElementById('response-container').textContent = data.response;
      } catch (error) {
          console.error(error);
          alert('Error asking Gemini');
      }
  });
  </script>

  <script src="app.js"></script>
</body>
</html>
